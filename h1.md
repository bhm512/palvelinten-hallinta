# h1

## a)

Debian 13 Trixien asennus onnistui toivotulla tavalla ja kone toimii odotetusti.

## b)

Salt minion asennettiin myös onnistuneesti. Näin etenin vaihe vaiheelta.
1. Lisäsin Repositoryn ja julkisen avaimen (PGP), onnistuneesti ohjeiden mukaan.
2. Asensin Saltin komennolla apt-get install salt-minion


## c)

Seuraavaksi testasin tärkeimmät Saltin tilafunktiot. Ensiksi testasin pkg funktiota, jonka avulla hallitaan ohjelmistopaketteja:

sudo salt-call --local state.single pkg.installed tree
sudo salt-call --local state.single pkg.removed tree

Näillä komennoilla Salt siis tarkastaa onko pakettia asennettu, jos ei ole se asentaa sen. Salt ei tee ns turhaa työtä jos paketti on jo oikeassa tilassa, eikä sitä ole syytä muuttaa.
Seuraavaksi testasin file funktiota, joka on tarkoitettu tiedostojen hallintaa varten. 

sudo salt-call --local state.single file.managed /tmp/hellotero contents="hello"
sudo salt-call --local state.single file.absent /tmp/hellotero

Näillä komennoilla Salt joko luo tai poistaa tiedoston halutulla sisällöllä. Jos tiedosto on jo oikein, niin sitä ei tarvitse muuttaa. 
Seuraavaksi testasin palveluita tai daemoneja ja sitä toimivatko ne. Näillä komennoilla siis pystyy hallinnoimaan onko palvelu käynnissä vai pysäytetty.

sudo salt-call --local state.single service.running apache2 enable=True
sudo salt-call --local state.single service.dead apache2 enable=False

Tässä kohtaa törmäsin pieneen ongelmaan, mutta se ratkesi nopeasti (en ollut uuteen virtuaalikoneeseeni vielä ladannut Apache2 palvelinta, joten asensin sen sudo apt-get install apache2 -y)
Näillä komennoilla siis Salt voi käynnistää tai lopettaa ohjelman tarpeen mukaan. 
Seuraavana user funktio, jolla Salt luo tai poistaa käyttäjiä ja hallitsee muutenkin ryhmiä ja kotihakemistoja. 

sudo salt-call --local -l info state.single user.present terote08
sudo salt-call --local -l info state.single user.absent terote08

Näiden komentojen avulla luotiin ja poistettiin käyttäjä nimeltä terote08. Salt tarkastaa siis onko käyttäjää olemassa ja luo tai poistaa sen miten vain käyttäjä haluaa. 
Viimeinen testattava oli cmd komento, jota käytetään komentojen suorittamiseen. 

sudo salt-call --local -l info state.single cmd.run 'touch /tmp/foo' creates="/tmp/foo"

Tällä komennolla Salt suorittaa komennon ja raportoi, jos siinä muutoksia. 

## d)

Idempotenssi tarkoittaa sitä, kun Salt komento suoritetaan monta kertaa peräjälkeen ja järjestelmä pysyy halutussa tilassa eikä se tee turhia muutoksia. 
Tätä komentoa testasin seuraavalla funkitolla:

sudo salt-call --local state.single file.managed /tmp/idemp_example contents="Hei Tero"

Ensimmäisellä kerralla Salt siis luo tiedoston /tmp/idemp_example ja kirjoittaa sinne "Hei Tero". 
Toisella kerralla testasin samalla komennolla:

sudo salt-call --local state.single file.managed /tmp/idemp_example contents="Hei Tero"

Nyt tässä tapauksessa Salt ei tee muutoksia ja tarkastaa vain halutun tilan. Ilmoitti että se on jo halutussa tilassa. Tässä oli esimerkki idempotenssista. 

Lähteet: 
https://terokarvinen.com/palvelinten-hallinta/
https://terokarvinen.com/2021/salt-run-command-locally/
https://terokarvinen.com/install-salt-on-debian-13-trixie/
https://docs.saltproject.io/salt/install-guide/en/latest/topics/install-by-operating-system/linux-deb.html
https://chatgpt.com/ (käytetty oman ymmärtämisen parantamiseksi)












