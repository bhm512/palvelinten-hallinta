# h1

Koneena toimii MacBook Air M2 2022 tietokone jossa on seuraavat
 , 8-core CPU 
 , 10-core GPU 
 , 8GB unified memory (RAM)
 , 1TB storage 

### muistiinpanot

- Salt on konfiguraatioon hallintaan tarkoitettu työkalu, jota käytetään infrastructure as a code menetelmällä
- Saltilla pystyy suorittamaan komentoja paikallisesti ja näkemään tuloksen  välittömästi
- Tärkeimmät komennot ovat pkg, file, cmd, service ja user
- Salttia käytetään yleensä hallinnoimaan suurta määrää orjatietokoneita verkossa.
- Raportin tulee kertoa täsmällisesti mitä teit ja miten, ja sitä tulisi kirjoittaa samalla kun tekee hommia.
- Pitää muistaa viitata kaikkiin lähteisiin!! Ei saa sepittää!

 
## a)

Debian 13 Trixien asennus onnistui toivotulla tavalla ja kone toimii odotetusti.

## b)

### PGP julkisen avaimen ja salt sources lataus

Salt minion asennettiin myös onnistuneesti. Näin etenin vaihe vaiheelta.

Ensiksi asensin wget:in, josta saan ladattua tarvittavat tiedostot
Sen tein komennoilla sudo apt-get update ja sudo apt-get install wget
Tämän jälkeen tein uuden kansion nimeltä saltrepo/ ja siirryin sinne (mkdir saltrepo/ ja cd saltrepo/)
Seuraavaksi latasin PGP-julkisen avaimen komennolla wget:

https://packages.broadcom.com/artifactory/api/security/keypair/SaltProjectKey/public

ja salt sources 

https://github.com/saltstack/salt-install-guide/releases/latest/download/salt.sources

### Salt-asennus

Ensiksi vielä päivitin komennolla sudo apt-get update ja asensin komennolla sudo apt-get install salt-minion salt-master

<img width="480" height="95" alt="Näyttökuva 2025-10-28 kello 11 14 35" src="https://github.com/user-attachments/assets/ae613b21-5797-4fa3-bfe4-e0a5b38d5862" />


## c)

### pkg

Seuraavaksi testasin tärkeimmät Saltin tilafunktiot. Ensiksi testasin pkg funktiota, jonka avulla hallitaan ohjelmistopaketteja:

Ajoin komennon sudo salt-call --local state.single pkg.installed tree

<img width="599" height="434" alt="Näyttökuva 2025-10-28 kello 11 20 23" src="https://github.com/user-attachments/assets/b332802d-44db-4b18-88b6-17e4a56be1ff" />


Tämä onnistui, koska tuloksessa näkyy kuinka tree paketti on asennettu, sekä Succeeded kohdassa näkyi 1 (changed=1)

Näillä komennoilla Salt siis tarkastaa onko pakettia asennettu, jos ei ole se asentaa sen. Salt ei tee ns turhaa työtä jos paketti on jo oikeassa tilassa, eikä sitä ole syytä muuttaa.

### file

Seuraavaksi testasin file funktiota, joka on tarkoitettu tiedostojen hallintaa varten. 

sudo salt-call --local state.single file.managed /tmp/artuntesti

<img width="445" height="386" alt="Näyttökuva 2025-10-28 kello 11 26 56" src="https://github.com/user-attachments/assets/a837c75c-cdb7-4a94-96f0-beac47a030ce" />

Tässä salt varmistaa, että tiedosto on olemassa
Testi onnistui, koska changes kohdassa näkyy, kuinka tmp/artuntesti luotiin.

Näillä komennoilla Salt joko luo tai poistaa tiedoston halutulla sisällöllä. Jos tiedosto on jo oikein, niin sitä ei tarvitse muuttaa.

<img width="445" height="460" alt="Näyttökuva 2025-10-28 kello 11 33 24" src="https://github.com/user-attachments/assets/afc42ab3-96bd-480e-9f05-f8a38609bb5d" />

Tässä vielä testi, joka näyttää, että tiedostoa on muutettu. 

### service

Seuraavaksi testasin palveluita tai daemoneja ja sitä toimivatko ne. Näillä komennoilla siis pystyy hallinnoimaan onko palvelu käynnissä vai pysäytetty.

Tässä kohtaa törmäsin pieneen ongelmaan, mutta se ratkesi nopeasti (en ollut uuteen virtuaalikoneeseeni vielä ladannut Apache2 palvelinta, joten asensin sen sudo apt-get install apache2 -y)
Näillä komennoilla siis Salt voi käynnistää tai lopettaa ohjelman tarpeen mukaan. 

<img width="662" height="376" alt="Näyttökuva 2025-10-28 kello 11 36 18" src="https://github.com/user-attachments/assets/0ca67d49-d793-4e9c-8af5-72447db30fd2" />

Tässä vielä lopputulos, joka kertoo että apache2 toimii

### user

Seuraavana user funktio, jolla Salt luo tai poistaa käyttäjiä ja hallitsee muutenkin ryhmiä ja kotihakemistoja. 


<img width="374" height="635" alt="Näyttökuva 2025-10-28 kello 11 42 45" src="https://github.com/user-attachments/assets/4a460bb9-4cd4-42eb-a3a1-2d373161a872" />


Näiden komentojen avulla luotiin ja poistettiin käyttäjä nimeltä ARTTU1. Salt tarkastaa siis onko käyttäjää olemassa ja luo tai poistaa sen miten vain käyttäjä haluaa. Molemmat kohdat toimivat

<img width="354" height="411" alt="Näyttökuva 2025-10-28 kello 11 43 55" src="https://github.com/user-attachments/assets/7192f8e0-0d13-484d-a372-1194ac01903b" />

### cmd

Viimeinen testattava oli cmd komento, jota käytetään komentojen suorittamiseen. 

sudo salt-call --local -l info state.single cmd.run 'touch /tmp/testi' creates="/tmp/testi"

<img width="425" height="458" alt="Näyttökuva 2025-10-28 kello 11 46 58" src="https://github.com/user-attachments/assets/5f19abd9-609f-4730-8f42-4460ebec69a0" />

Testi onnistui, koska result on: True ja comment on Command "touch /tmp/testi" run eli tiedosto luotiin 


## d) Idempotentti

Idempotenssi tarkoittaa sitä, kun Salt komento suoritetaan monta kertaa peräjälkeen ja järjestelmä pysyy halutussa tilassa eikä se tee turhia muutoksia. 
Tätä komentoa testasin seuraavalla funkitolla: sudo salt-call --local -l info state.single user.present ARTTU

<img width="519" height="255" alt="Näyttökuva 2025-10-28 kello 11 50 57" src="https://github.com/user-attachments/assets/0f7d7b12-ecb5-4e06-bfb0-472f3571a310" />

Ajoin tämän komennon kahdesti, josta nähtiin ensimmäisellä kerralla varmistin käyttäjän ja toisella ajolla se kertoi että käyttäjä on 
"present and up to date"

Nyt tässä tapauksessa Salt ei tee muutoksia ja tarkastaa vain halutun tilan. Ilmoitti että se on jo halutussa tilassa. Tässä oli esimerkki idempotenssista. 

Lähteet: 
https://terokarvinen.com/palvelinten-hallinta/
https://terokarvinen.com/2021/salt-run-command-locally/
https://terokarvinen.com/install-salt-on-debian-13-trixie/
https://docs.saltproject.io/salt/install-guide/en/latest/topics/install-by-operating-system/linux-deb.html
https://chatgpt.com/ (käytetty oman ymmärtämisen parantamiseksi)












